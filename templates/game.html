{% extends "layout.html" %}
{% from "utils.html" import info, card %}

{% set active_page = 'game' %}

{% block navbar_middle %}
<div class="uk-navbar-center">
    <ul class="uk-dotnav">
        <li class="step"><a href="#"></a></li>
        <li class="step"><a href="#"></a></li>
        <li class="step"><a href="#"></a></li>
        <li class="step"><a href="#"></a></li>
    </ul>
</div>
{% endblock %}

{% block footer %}
<p class="uk-flex-inline uk-flex-center uk-margin-remove-bottom">This is a game, do not take results seriosly</p>
{% endblock %}

{% block central %}
<form class="uk-section uk-flex uk-flex-middle uk-text-center" id="main-content" action="submit" method="get">
    <div class="uk-width-1-1">

        <!-- tumor type selection -->
        <div class="uk-container tab">

            <p class="uk-margin-medium uk-text-lead">
                Sample selection
                {{ info('ttype') }}
            </p>

            <p class="uk-margin-medium">
                Two samples have arrived at the lab: one is labelled as lung cancer and the other one as skin cancer.
                <br>
                To start playing, choose one to analyse
            </p>

            <div uk-grid class="uk-child-width-1-2@m uk-child-width-1-1@s uk-grid uk-grid-match">
                <div>
                    {{ card('skin', 'skin.svg', 'Skin cancer', 'Skin cancer develops from the cells that made up the skin') }}
                </div>
                <div>
                    {{ card('lung', 'lung.svg', 'Lung cancer', 'Lung cancer  develops from the cells that made up the lungs') }}
                </div>
            </div>
            <input type="hidden" id="ttype" name="ttype">
        </div>

        <!-- risk factor I -->
        <div class="uk-container tab">

            <p class="uk-margin-medium uk-text-lead">
                Patient risk factors
                {{ info('ttype') }}
            </p>

            <p class="uk-margin-medium">
                Please, select the level of exposure of your patient to known risk factors of the cancer type
            </p>

            <p class="uk-margin-medium uk-text-lead">
                Age
            </p>

            <div class="branch-skin">

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'skin/age_1.svg', 'Very young patient', 'Generally, cancers of young people have few mutations') }}
                    </div>
                    <div>
                        {{ card(2, 'skin/age_2.svg', 'Middle age patient', 'Generally, cancers of middle age people will have more mutations than those from young people, but less than the elderly') }}
                    </div>
                    <div>
                        {{ card(3, 'skin/age_3.svg', 'Aged patient', 'Generally, cancers of aged people have more mutations than those of younger age') }}
                    </div>
                </div>
            </div>

            <div class="branch-lung">

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'lung/age_1.svg', 'Young', 'Mutations accumulate over time. Young people do not have many mutations accumulated.') }}
                    </div>
                    <div>
                        {{ card(2, 'lung/age_2.svg', 'Middle age', ' Mutations accumulate over time. Middle aged people do accumulate quite a few.') }}
                    </div>
                    <div>
                        {{ card(3, 'lung/age_3.svg', 'Elderly', ' Mutations accumulate over time. Elderly people have a lot of them.') }}
                    </div>
                </div>
            </div>

            <input type="hidden" id="riskFactor1" name="riskFactor1">
        </div>

        <!-- risk factor II -->
        <div class="uk-container tab">

            <p class="uk-margin-medium uk-text-lead">
                Patient risk factors
                {{ info('ttype') }}
            </p>

            <p class="uk-margin-medium">
                Please, select the level of exposure of your patient to known risk factors of the cancer type
            </p>

            <div class="branch-skin">

                <p class="uk-margin-medium uk-text-lead">
                    Sun exposure
                </p>

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'skin/sun_1.svg', 'Low sun exposure', 'The patient exposure to UV radiation is below the average. The number of tumor mutations attributed to sun exposure is likely to be low') }}
                    </div>
                    <div>
                        {{ card(2, 'skin/sun_2.svg', 'Moderate sun exposure', 'The patient exposure to UV radiation is on the average. The number of tumor mutations attributed to sun exposure is likely to be moderate') }}
                    </div>
                    <div>
                        {{ card(3, 'skin/sun_3.svg', 'High sun exposure', 'The patient exposure to UV radiation is above the average. The number of tumor mutations attributed to sun exposure is likely to be high') }}
                    </div>
                </div>
            </div>

            <div class="branch-lung">

                <p class="uk-margin-medium uk-text-lead">
                    Smoking
                </p>

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'lung/smoking_1.svg', 'Non-smoker', 'You do not smoke') }}
                    </div>
                    <div>
                        {{ card(2, 'lung/smoking_2.svg', 'Ocassional', 'Every now and then you smoke') }}
                    </div>
                    <div>
                        {{ card(3, 'lung/smoking_3.svg', 'Regular', 'You smoke on a regular basis') }}
                    </div>
                </div>
            </div>

            <input type="hidden" id="riskFactor2" name="riskFactor2">
        </div>

        <!-- risk factor III -->
        <div class="uk-container tab">

            <p class="uk-margin-medium uk-text-lead">
                Patient risk factors
                {{ info('ttype') }}
            </p>

            <p class="uk-margin-medium">
                Please, select the level of exposure of your patient to known risk factors of the cancer type
            </p>

            <div class="branch-skin">

                <p class="uk-margin-medium uk-text-lead">
                    Sun protection
                </p>

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'skin/protection_1.svg', 'High protection', 'The patient frequently uses high-grade factor sunscreen and sun protective clothes when exposed to UV radiation. The number of tumor mutations attributed to sun exposure is likely to be lower than those with intermediate or no sun protection') }}
                    </div>
                    <div>
                        {{ card(2, 'skin/protection_2.svg', 'Intermediate protection', 'The patient sporadically uses sun protection when exposed to UV radiation. The number of tumor mutations attributed to sun exposure is likely to be lower than those with no sun protection, but higher than those with high protection') }}
                    </div>
                    <div>
                        {{ card(3, 'skin/protection_3.svg', 'Low protection',  'The patient does not use sunscreen nor protective clothes when exposed to UV radiation. The number of tumor mutations attributed to sun exposure is likely to be higher than those that use sun protection') }}
                    </div>
                </div>
            </div>

            <div class="branch-lung">

                <p class="uk-margin-medium uk-text-lead">
                    Age
                </p>

                <div uk-grid class="uk-child-width-1-3@l uk-child-width-1-1@s uk-grid uk-grid-match">
                    <div>
                        {{ card(1, 'lung/secondhsmoking_1.svg', 'Stay apart', 'You keep distance with smokers') }}
                    </div>
                    <div>
                        {{ card(2, 'lung/secondhsmoking_2.svg', 'Ocassional passive smoker', 'You are a passive smoker in the terraces') }}
                    </div>
                    <div>
                        {{ card(3, 'lung/secondhsmoking_3.svg', 'Passive smoker', 'Close relatives/friends are smoker and you are with them regularly') }}
                    </div>
                </div>
            </div>

            <input type="hidden" id="riskFactor3" name="riskFactor3">
        </div>

    </div>

    <input type="hidden" id="code" name="code">
</form>

{% endblock %}

{% block script %}
{{ super() }}
<script>
    // add "for" attribute to each select item
    $( "span:contains('Select')" ).each(function () {
       let inputId = $( this ).closest( ".tab" ).find( "input" ).attr( "id" );
       $( this ).attr( "for", inputId);
    });
    // hide all branches
    $(".branch-skin").hide();
    $(".branch-lung").hide();

    $(document).ready(function() {
        showTab(currentTab);
        $( "span:contains('Select')" ).click(selectCard);

        $("#code").attr( "value", randomCode());
    });
    $("#info-ttype").click(function () {
        swal("The tumor type", "The tumor type...");
    });
</script>
{% endblock %}

